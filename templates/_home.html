{% extends 'boilerplate.html' %}

{% block javascript_includes %}

    {% if session.user_signed_in %}

        <script 
            type='text/javascript'
            src='{{ url_for("static", filename="channel.js") }}'>
        </script>

        <script 
            type='text/javascript' 
            src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js">
        </script>

    {% endif %}

{% endblock %}

{% block side %}

    {% if session.user_signed_in %}

        <h2> channels </h2>

        <form class='channel_form'>
            <input type='text' id='channel' name='channel'>
            <button id='add_channel'> Add </button>
        </form>

        <ul id='channels'> 
            {% for menuitem in chat_channels %} 
                {% if menuitem == 'general' %}
                    <li class='active_channel'> {{ menuitem }} </li>
                {% else %}
                    <li> {{ menuitem }} </li>
                {% endif %}
            {% endfor %}
        </ul>

    {% endif %}

{% endblock %}

{% block main %}

    {% if session.user_signed_in %}

    <h2> #{{ current_channel }} </h2>

    <div class='title'></div>
    <div class='content'>
        {% for msg in chat_history %}
        <div style='margin: 0.5em 0.5em;'>
            <div style='font-weight: bold'> {{ msg.sender }} </div>
            <div style='font-size: 95%'> {{ msg.content }} </div>
        </div>
        {% endfor %}
    </div>
    
    <div class='message_form'>
        <form id='message_form' method='post'>
            <input id='message' type='text'/> <button id='send_message'> Send </button>
        </form>
    </div>

    {% endif %}

{% endblock %}

{% block signin %}

    {% if session.user_signed_in %}

        <h1> my spam </h1>
        <form id='signout_form' action='/signout' method='post'>
            <span> display name: </span>
            <span id='current_user'> {{ session.user_signed_in }} </span>
            <button> Logout </button>
        </form>

    {% else %}

        <h1> my spam </h1>
        <form id='signin_form' action='/signin' method='post'>
            <label for='user_id'>
                <span> display name: </span> <input id='userid' name='userid' type='text'/>
            </label>
            <button> Go </button>
        </form>

    {% endif %}

{% endblock %}
