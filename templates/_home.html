{% extends 'boilerplate.html' %}

{% block javascript_includes %}

    {% if session.user_signed_in %}

        <script 
            type='text/javascript'
            src='{{ url_for("static", filename="channel.js") }}'>
        </script>

        <script 
            type='text/javascript' 
            src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js">
        </script>

    {% endif %}

{% endblock %}

{% block side %}

    {% if session.user_signed_in %}

        <h2> channels </h2>

        <div>
            <select id='channelselector' style='display: inline-block'>
                {% for menuitem in chat_channels %} 
                    <option value='{{ menuitem }}'> {{ menuitem }} </option>
                {% endfor %}
            </select>
            <span id='add_channel'>
                <form style='display: inline-block' class='channel_form'>
                        <button id='new_channel'> New </button>
                    <span id='toggle_create' style='display: none'>
                        <input type='text' id='channel' name='channel'>
                        <button id='add_channel'> Create </button>
                    </span>
                </form>
            </span>    
        </div>

    {% endif %}

{% endblock %}

{% block main %}

    {% if session.user_signed_in %}

    <div class='title'></div>
    <div class='content'>
        {% for msg in chat_history %}
        <div>
            <div style='font-weight: bold'> {{ msg.sender }} </div>
            <div style='font-size: 95%'> {{ msg.content }} </div>
        </div>
        {% endfor %}
    </div>
    
    {% endif %}

{% endblock %}

{% block signin %}

    {% if session.user_signed_in %}

        <h1> my spam </h1>
        <form id='signout_form' action='/signout' method='post'>
            <span> user: </span>
            <span id='current_user'> {{ session.user_signed_in }} </span>
            <button> Logout </button>
        </form>

    {% else %}

        <h1> my spam </h1>
        <form id='signin_form' action='/signin' method='post'>
            <label for='user_id'>
                <span> user: </span> <input id='userid' name='userid' type='text'/>
            </label>
            <button> Go </button>
        </form>

    {% endif %}

{% endblock %}

{% block work %}

    <div class='message_form'>
        <form id='message_form' method='post'>
            <input id='message' type='text'/> <button id='send_message'> Send </button>
        </form>
    </div>

{% endblock %}